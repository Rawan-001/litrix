import{r,I as L,_ as P,j as e,L as x,A as z,m as A,a as j,d as N,b as f,g as v,c as U,e as V}from"./index-IRUkcUQr.js";import k from"./AdminDashboard-CqBF9du8.js";import H from"./ResearcherDashboard-C6xvouk9.js";import{V as O}from"./DashboardViewSwitcher-BGsbw_mV.js";import{H as B}from"./Header-Q4VJ-w9q.js";import"./Box-oQB4NEfc.js";import"./clsx-B-dksMZM.js";import"./dividerClasses-CqYxHbZ8.js";import"./Divider-D03vUDS8.js";import"./TextField-Bkbwt7zy.js";import"./Tooltip-CSSa6YlJ.js";import"./ListItemText-BP7W8oIJ.js";import"./generateCategoricalChart-BQQ0_7Rj.js";import"./LineChart-DYHXU8TT.js";import"./GridLoader-DRl0MpW0.js";var J={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M168 504.2c1-43.7 10-86.1 26.9-126 17.3-41 42.1-77.7 73.7-109.4S337 212.3 378 195c42.4-17.9 87.4-27 133.9-27s91.5 9.1 133.8 27A341.5 341.5 0 01755 268.8c9.9 9.9 19.2 20.4 27.8 31.4l-60.2 47a8 8 0 003 14.1l175.7 43c5 1.2 9.9-2.6 9.9-7.7l.8-180.9c0-6.7-7.7-10.5-12.9-6.3l-56.4 44.1C765.8 155.1 646.2 92 511.8 92 282.7 92 96.3 275.6 92 503.8a8 8 0 008 8.2h60c4.4 0 7.9-3.5 8-7.8zm756 7.8h-60c-4.4 0-7.9 3.5-8 7.8-1 43.7-10 86.1-26.9 126-17.3 41-42.1 77.8-73.7 109.4A342.45 342.45 0 01512.1 856a342.24 342.24 0 01-243.2-100.8c-9.9-9.9-19.2-20.4-27.8-31.4l60.2-47a8 8 0 00-3-14.1l-175.7-43c-5-1.2-9.9 2.6-9.9 7.7l-.7 181c0 6.7 7.7 10.5 12.9 6.3l56.4-44.1C258.2 868.9 377.8 932 512.2 932c229.2 0 415.5-183.7 419.8-411.8a8 8 0 00-8-8.2z"}}]},name:"sync",theme:"outlined"},q=function(m,h){return r.createElement(L,P({},m,{ref:h,icon:J}))},D=r.forwardRef(q);const{Content:_}=x,oe=()=>{const[s,m]=r.useState("admin"),[h,p]=r.useState(!1),[R,n]=r.useState(!0),[i,S]=r.useState(null),[u,g]=r.useState(null),[$,F]=r.useState(null);r.useEffect(()=>{(async()=>{if(console.log("Initializing AcademicAdminDashboard"),!j.currentUser){console.log("No authenticated user"),n(!1);return}try{const t=j.currentUser.uid;console.log("Current user UID:",t);const l=N(f,`academicAdmins/${t}`),c=await v(l);if(!c.exists()){console.error("No academic admin data found"),n(!1);return}let a=c.data();console.log("Raw academic admin data:",a),a.college||(a.college="faculty_computing",console.log("Adding default college value: faculty_computing")),a.department||(a.department="dept_cs",console.log("Adding default department value: dept_cs")),t==="HtPaSB6NgUVD8XWeTqPPevk0RzG3"?a.scholar_id="JSQbyBgAAAAJ":t==="OWA24pjOxNOKUHqcmgoM4i3rC8q2"&&(a.scholar_id="05Jx6QkAAAAJ"),console.log("Processed academic admin data:",a),S(a),await C(a)}catch(t){console.error("Error fetching academic admin data:",t),n(!1)}})()},[]);const C=async o=>{try{const t=o.college||"faculty_computing",l=o.department||"dept_cs",c=o.scholar_id;if(console.log("Attempting to fetch researcher data with path components:",{college:t,department:l,scholarId:c}),!c){console.error("No scholar_id available for academic admin"),n(!1);return}const a=N(f,`colleges/${t}/departments/${l}/faculty_members/${c}`);console.log(`Full path to researcher data: ${a.path}`);const y=await v(a);if(y.exists()){const w=y.data();console.log("Researcher data found:",w);const b={...w,id:c||"default_id",scholar_id:c||"default_scholar_id",college:t||"default_college",department:l||"default_department"};console.log("Enriched researcher data:",b),g(b);try{const d=U(f,`colleges/${t}/departments/${l}/faculty_members/${c}/publications`);console.log(`Checking publications at path: ${d.path}`);const I=await V(d);console.log(`Found ${I.size} publications`)}catch(d){console.error("Error checking publications:",d)}}else console.error(`No researcher document found at path: ${a.path}`),g(null)}catch(t){console.error("Error fetching researcher data:",t)}finally{n(!1)}},E=o=>{o!==s&&(p(!0),setTimeout(()=>{m(o),p(!1)},400))};return R?e.jsx(x,{className:"w-full bg-gray-50 flex-1 flex flex-col overflow-x-hidden",children:e.jsx(_,{className:"p-6 flex-1 overflow-auto",children:e.jsx("div",{className:"flex justify-center items-center h-64 bg-white p-8 rounded-lg shadow-sm my-4",children:e.jsxs("div",{className:"flex flex-col items-center justify-center text-center",children:[e.jsx(D,{spin:!0,style:{fontSize:36},className:"text-blue-500 mb-4"}),e.jsx("h4",{className:"text-xl font-medium text-gray-700 m-0",children:"Loading Dashboard"}),e.jsx("p",{className:"text-gray-500 mt-2",children:"Please wait while we prepare your dashboard"})]})})})}):(console.log("Rendering dashboard with view:",s),console.log("Researcher data available:",!!u),e.jsxs(x,{className:"w-full bg-gray-50 flex-1 flex flex-col overflow-x-hidden",children:[e.jsx(B,{title:s==="admin"?"Admin Dashboard":"Researcher Dashboard",showViewSwitcher:!1,isAcademicAdmin:!0}),e.jsxs(_,{className:"p-6 flex-1 overflow-auto",children:[e.jsx("div",{className:"flex justify-end mb-6",children:e.jsx(O,{currentView:s,departmentCode:(i==null?void 0:i.department)||"dept_cs",onClick:E})}),e.jsx(z,{mode:"wait",children:h?e.jsx(A.div,{className:"flex justify-center items-center h-64 bg-white p-8 rounded-lg shadow-sm my-4",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:e.jsxs("div",{className:"flex flex-col items-center justify-center text-center",children:[e.jsx(D,{spin:!0,style:{fontSize:36},className:"text-blue-500 mb-4"}),e.jsxs("h4",{className:"text-xl font-medium text-gray-700 m-0",children:["Loading ",s==="admin"?"Researcher":"Admin"," Dashboard"]}),e.jsx("p",{className:"text-gray-500 mt-2",children:"Please wait while we prepare your view"})]})},"loading"):e.jsx(A.div,{initial:{opacity:0,x:s==="admin"?-20:20},animate:{opacity:1,x:0},exit:{opacity:0,x:s==="admin"?20:-20},transition:{duration:.3},className:"w-full h-full",children:s==="admin"?e.jsx(k,{academicAdminData:i,hideHeader:!0}):u?e.jsx(H,{academicAdminAsResearcher:!0,researcherData:u,academicAdminData:i,userData:$||i,hideHeader:!0}):e.jsx("div",{className:"flex justify-center items-center h-64 bg-white p-8 rounded-lg shadow-sm my-4",children:e.jsxs("div",{className:"flex flex-col items-center justify-center text-center",children:[e.jsx("h4",{className:"text-xl font-medium text-gray-700 m-0",children:"No Researcher Data Found"}),e.jsx("p",{className:"text-gray-500 mt-2",children:"Please check the researcher's information in the database."})]})})},s)})]})]}))};export{oe as default};

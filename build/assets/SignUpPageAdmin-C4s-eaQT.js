import{r as d,aw as _,y as A,j as e,aj as n,ak as c,am as h,ap as L,a as y,d as q,b as E,ao as R,aq as B}from"./index-IRUkcUQr.js";import{R as D,a as $,S as P}from"./index-baVK1xfK.js";import{s as m}from"./index-C3I17fsu.js";const{Step:U}=P,G=()=>{const[i,f]=d.useState(0),[g]=_(),[r,S]=d.useState(""),[j,v]=d.useState(""),[a,k]=d.useState({email:"",password:"",confirmPassword:"",firstName:"",lastName:"",googleScholarLink:""}),w=A();d.useEffect(()=>{const t=g.get("role"),s=g.get("department");S(t||""),v(s||"")},[g]);const C=()=>{if(i===0&&a.password!==a.confirmPassword){m.error("Passwords do not match");return}f(t=>t+1)},b=()=>{f(t=>t-1)},l=t=>{const{name:s,value:o}=t.target;k(x=>({...x,[s]:o}))},I=t=>{const s=/^https?:\/\/scholar\.google\.com\/citations\?(?:.*&)?user=([a-zA-Z0-9_-]+)(?:&.*)?$/,o=t.trim().match(s);return o?o[1]:null},N=async()=>{if(a.password!==a.confirmPassword){m.error("Passwords do not match");return}const t=r==="department_admin"||r==="academic_admin"?I(a.googleScholarLink):null;if((r==="department_admin"||r==="academic_admin")&&!t){m.error("Invalid Google Scholar profile link");return}try{const o=(await L(y,a.email,a.password)).user,x=q(E,`${r==="academic_admin"?"academicAdmins":r==="department_admin"?"departmentAdmins":"admins"}/${o.uid}`);await R(x,{uid:o.uid,email:a.email,firstName:a.firstName,lastName:a.lastName,role:r,...j&&{department:j},...t&&{googleScholarLink:a.googleScholarLink,scholarId:t,scholar_id:t}}),await B(y,a.email,a.password),m.success("Account created successfully!"),w("/")}catch(s){m.error(`Error: ${s.message}`)}},u=[{title:"Account Info",content:e.jsxs(n,{layout:"vertical",children:[e.jsx(n.Item,{label:"Email",required:!0,children:e.jsx(c,{type:"email",value:a.email,name:"email",onChange:l})}),e.jsx(n.Item,{label:"Password",required:!0,children:e.jsx(c.Password,{value:a.password,name:"password",onChange:l})}),e.jsx(n.Item,{label:"Confirm Password",required:!0,children:e.jsx(c.Password,{value:a.confirmPassword,name:"confirmPassword",onChange:l})})]})},{title:"Personal Info",content:e.jsxs(n,{layout:"vertical",children:[e.jsx(n.Item,{label:"First Name",required:!0,children:e.jsx(c,{value:a.firstName,name:"firstName",onChange:l})}),e.jsx(n.Item,{label:"Last Name",required:!0,children:e.jsx(c,{value:a.lastName,name:"lastName",onChange:l})}),(r==="department_admin"||r==="academic_admin")&&e.jsx(n.Item,{label:"Google Scholar Profile Link",required:!0,children:e.jsx(c,{prefix:e.jsx(D,{}),placeholder:"https://scholar.google.com/citations?user=XXXX",value:a.googleScholarLink,name:"googleScholarLink",onChange:l})})]})}];return e.jsx("div",{style:p.container,children:e.jsxs("div",{style:p.card,children:[e.jsx(h,{type:"link",icon:e.jsx($,{}),onClick:()=>w("/"),style:p.backButton,children:"Back to Home"}),e.jsx(P,{current:i,style:{marginBottom:20},children:u.map((t,s)=>e.jsx(U,{title:t.title},s))}),e.jsx("div",{children:u[i].content}),e.jsxs("div",{style:p.buttons,children:[i>0&&e.jsx(h,{onClick:b,children:"Previous"}),i<u.length-1&&e.jsx(h,{type:"primary",onClick:C,children:"Next"}),i===u.length-1&&e.jsx(h,{type:"primary",onClick:N,children:"Submit"})]})]})})},p={container:{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"100vh",backgroundColor:"#f0f2f5"},card:{width:"100%",maxWidth:"600px",padding:"40px",backgroundColor:"#fff",borderRadius:"12px",boxShadow:"0 6px 16px rgba(0, 0, 0, 0.1)"},backButton:{marginBottom:16},buttons:{marginTop:24,display:"flex",justifyContent:"flex-end",gap:"8px"}};export{G as default};

import{r as o,j as e,e as b,c as p,b as w}from"./index-IRUkcUQr.js";import{H as z}from"./Header-Q4VJ-w9q.js";const Y=({college:m,department:h,scholarId:y})=>{const[c,f]=o.useState([]),[n,j]=o.useState(""),[d,v]=o.useState(!1),[r,x]=o.useState(null),[N,u]=o.useState(null),k=o.useRef(null),I=o.useRef(null),L=t=>t.filter(s=>s&&s.trim()!==""),M=t=>{const s=L(["colleges",m,"departments",h,"faculty_members",t,"publications"]);if(s.length<7)throw new Error("Invalid path: Missing required segments (college, department, or scholarId)");return p(w,s.join("/"))},$=()=>{var t;(t=I.current)==null||t.scrollIntoView({behavior:"smooth"})};o.useEffect(()=>{$()},[c]);const C=async t=>{try{if(!t)throw new Error("Scholar ID is required");const s=M(t);return(await b(s)).docs.map(l=>l.data()).filter(l=>l.pub_year===2024).sort((l,g)=>new Date(g.date)-new Date(l.date))}catch(s){return console.error("Error fetching recent publications:",s),u(`Unable to fetch publications: ${s.message}`),[]}},P=async()=>{try{if(!m||!h)throw new Error("College and department information is required");const t=L(["colleges",m,"departments",h,"faculty_members"]),s=p(w,t.join("/")),a=await b(s),i=new Set;for(const l of a.docs){const g=l.data(),H=p(w,t.join("/"),l.id,"publications");(await b(H)).docs.forEach(U=>{const R=U.data();R.abstract&&R.abstract.includes("Artificial Intelligence")&&i.add(g.name)})}return Array.from(i)}catch(t){return console.error("Error finding collaborators:",t),u(`Unable to find collaborators: ${t.message}`),[]}},A=async()=>{try{const t=await C(y);if(t.length===0)return"I couldn't find recent publications to base a suggestion on. Please make sure your publication data is available.";const s=`Based on the following recent publications:
${t.map(a=>`${a.title}: ${a.abstract}`).join(`
`)}
Suggest a creative new research idea for this faculty member.`;return"Based on your recent publications, I suggest exploring the intersection of machine learning and data visualization techniques to create more intuitive representations of complex research findings."}catch(t){return console.error("Error suggesting research idea:",t),u("Unable to suggest a research idea at this time."),"I'm unable to suggest a research idea at this moment."}},D=t=>{t.target.files&&t.target.files[0]&&x(t.target.files[0])},B=()=>{k.current.click()},S=async()=>{if(!n.trim()&&!r)return;u(null);let t={role:"user",text:n};r&&(t.file={name:r.name,type:r.type,url:URL.createObjectURL(r)}),f([...c,t]),j(""),x(null),v(!0);try{let s="";if(n.toLowerCase().includes("recent publications")){const a=await C(y);a.length>0?s=`Here are your recent publications: ${a.map(i=>i.title).join(", ")}`:s="I couldn't find any recent publications. Please make sure your data is properly configured."}else if(n.toLowerCase().includes("find collaborators in ai research")){const a=await P();a.length>0?s=`Here are potential collaborators in AI: ${a.join(", ")}`:s="I couldn't find any AI research collaborators at this time."}else n.toLowerCase().includes("suggest a new research idea")?s=`Here's a creative research idea for you: ${await A()}`:r&&!n.trim()?s=`I've received your file: ${r.name}. How would you like me to analyze this document?`:s="Sorry, I didn't understand that. You can ask me about recent publications, finding collaborators in AI research, or suggesting new research ideas.";f(a=>[...a,{role:"bot",text:s}])}catch(s){console.error("Error processing message:",s),f(a=>[...a,{role:"bot",text:"An error occurred while processing your request. Please check the console for details."}])}finally{v(!1)}};return e.jsxs("div",{className:"flex-1 relative z-10 overflow-hidden flex flex-col h-full bg-gradient-to-b from-blue-50 to-white",children:[e.jsx(z,{title:"Litrix Chat"}),e.jsxs("div",{className:"flex-1 flex flex-col max-w-4xl w-full mx-auto p-4 h-[calc(100vh-64px)]",children:[N&&e.jsx("div",{className:"bg-red-50 text-red-600 p-3 rounded-lg mb-4 shadow-sm border border-red-200 animate-fade-in",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-2 text-red-500",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),e.jsx("span",{children:N})]})}),e.jsx("div",{className:"flex-1 overflow-y-auto mb-4 pr-2",children:e.jsxs("div",{className:"space-y-4 py-2",children:[c.length===0&&e.jsx("div",{className:"flex justify-center my-8",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 shadow-md max-w-lg",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:"Welcome to Litrix Chat"}),e.jsx("p",{className:"text-gray-600 mb-3",children:"You can ask me about:"}),e.jsxs("ul",{className:"space-y-2 text-gray-600 mb-2",children:[e.jsxs("li",{className:"flex items-center",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-blue-500 mr-2"}),"Recent scientific publications"]}),e.jsxs("li",{className:"flex items-center",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-blue-500 mr-2"}),"Finding AI research collaborators"]}),e.jsxs("li",{className:"flex items-center",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-blue-500 mr-2"}),"Suggesting new research ideas"]})]})]})}),c.map((t,s)=>e.jsxs("div",{className:`flex ${t.role==="user"?"justify-end":"justify-start"} animate-fade-in-up`,style:{animationDelay:`${s*.1}s`},children:[t.role==="bot"&&e.jsx("div",{className:"flex items-center justify-center w-8 h-8 rounded-full bg-gradient-to-r from-blue-500 to-blue-600 text-white font-medium shadow-md mr-2",children:"L"}),e.jsxs("div",{className:`max-w-[75%] px-4 py-3 rounded-2xl shadow-sm ${t.role==="user"?"bg-gradient-to-r from-blue-500 to-blue-600 text-white rounded-tr-none":"bg-white text-gray-800 rounded-tl-none"}`,children:[t.file&&e.jsx("div",{className:"mb-2",children:e.jsxs("div",{className:"flex items-center p-2 bg-white bg-opacity-20 rounded-lg",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15.172 7l-6.586 6.586a2 2 0 102.828 2.828l6.414-6.586a4 4 0 00-5.656-5.656l-6.415 6.585a6 6 0 108.486 8.486L20.5 13"})}),e.jsx("span",{className:"text-sm truncate",children:t.file.name})]})}),e.jsx("p",{className:"text-sm md:text-base whitespace-pre-wrap",children:t.text})]}),t.role==="user"&&e.jsx("div",{className:"flex items-center justify-center w-8 h-8 rounded-full bg-gray-200 text-gray-600 font-medium shadow-sm ml-2",children:"U"})]},s)),d&&e.jsxs("div",{className:"flex justify-start animate-fade-in",children:[e.jsx("div",{className:"flex items-center justify-center w-8 h-8 rounded-full bg-gradient-to-r from-blue-500 to-blue-600 text-white font-medium shadow-md mr-2",children:"L"}),e.jsx("div",{className:"bg-white px-4 py-3 rounded-2xl shadow-sm rounded-tl-none",children:e.jsxs("div",{className:"flex space-x-1",children:[e.jsx("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce",style:{animationDelay:"0s"}}),e.jsx("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce",style:{animationDelay:"0.2s"}}),e.jsx("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce",style:{animationDelay:"0.4s"}})]})})]}),e.jsx("div",{ref:I})]})}),r&&e.jsxs("div",{className:"bg-blue-50 p-2 rounded-lg mb-2 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-blue-500 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15.172 7l-6.586 6.586a2 2 0 102.828 2.828l6.414-6.586a4 4 0 00-5.656-5.656l-6.415 6.585a6 6 0 108.486 8.486L20.5 13"})}),e.jsx("span",{className:"text-sm text-blue-700 truncate",children:r.name})]}),e.jsx("button",{onClick:()=>x(null),className:"text-blue-500 hover:text-blue-700",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsx("div",{className:"sticky bottom-0 bg-white rounded-2xl shadow-lg p-2 border border-gray-200",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"file",ref:k,onChange:D,className:"hidden",accept:"image/*,.pdf,.doc,.docx,.xlsx,.xls,.csv,.txt"}),e.jsx("button",{onClick:B,className:"p-2 text-gray-500 hover:text-blue-500 transition",title:"Attach file",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15.172 7l-6.586 6.586a2 2 0 102.828 2.828l6.414-6.586a4 4 0 00-5.656-5.656l-6.415 6.585a6 6 0 108.486 8.486L20.5 13"})})}),e.jsx("input",{type:"text",value:n,onChange:t=>j(t.target.value),onKeyPress:t=>t.key==="Enter"&&S(),placeholder:"Type a message...",className:"flex-1 p-3 focus:outline-none text-gray-700 placeholder-gray-400 text-base",disabled:d}),e.jsx("button",{onClick:S,disabled:d||!n.trim()&&!r,className:`ml-2 p-2 rounded-full ${d||!n.trim()&&!r?"bg-gray-200 text-gray-400 cursor-not-allowed":"bg-blue-500 text-white hover:bg-blue-600 transition"}`,children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",className:"w-6 h-6 transform rotate-90",children:e.jsx("path",{d:"M3.478 2.404a.75.75 0 0 0-.926.941l2.432 7.905H13.5a.75.75 0 0 1 0 1.5H4.984l-2.432 7.905a.75.75 0 0 0 .926.94 60.519 60.519 0 0 0 18.445-8.986.75.75 0 0 0 0-1.218A60.517 60.517 0 0 0 3.478 2.404Z"})})})]})})]})]})},E=document.createElement("style");E.textContent=`
    @keyframes fadeInUp {
        from {
            opacity: 0;
            transform: translateY(10px);
        }
        to {
            opacity: 1;
            transform: translateY(0);
        }
    }
    
    .animate-fade-in-up {
        animation: fadeInUp 0.3s ease-out forwards;
    }
    
    .animate-fade-in {
        animation: fadeIn 0.3s ease-out forwards;
    }
    
    @keyframes fadeIn {
        from {
            opacity: 0;
        }
        to {
            opacity: 1;
        }
    }
`;document.head.appendChild(E);export{Y as default};

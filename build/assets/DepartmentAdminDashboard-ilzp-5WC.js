import{r,c as F,b as k,e as I,q as fe,w as je,M as pe,f as q,F as J,j as e,h as ye,m as G,i as ve,k as ne,l as we,R as be,p as ie,s as ge,t as Ne,a as Pe,d as oe,g as ce,u as Ce,v as Se,x as ke,o as Ie,n as Ae}from"./index-IRUkcUQr.js";import{H as te}from"./Header-Q4VJ-w9q.js";import{T as b,B as _e}from"./Box-oQB4NEfc.js";import{C as D,P as Ye,a as Re,B as de,b as Te,A as De}from"./dividerClasses-CqYxHbZ8.js";import{D as Fe,I as ue,a as Le,b as Me,c as $e,d as ze}from"./Divider-D03vUDS8.js";import{P as Ee,T as Be,I as Ke,L as We}from"./TextField-Bkbwt7zy.js";import{T as xe}from"./Tooltip-CSSa6YlJ.js";import{L as Ve,a as me,b as Oe,c as he}from"./ListItemText-BP7W8oIJ.js";import{V as Ue}from"./DashboardViewSwitcher-BGsbw_mV.js";import{G as Qe}from"./GridLoader-DRl0MpW0.js";import"./clsx-B-dksMZM.js";const H={dept_cs:"Computer Science",dept_it:"Information Technology",dept_se:"Software Engineering",dept_sn:"Network Systems"},He=({statistics:a,selectedDepartment:i="dept_cs"})=>{const h=new Date().getFullYear(),[x,m]=r.useState(!1),[w,L]=r.useState(""),[Y,A]=r.useState(""),[n,X]=r.useState([]),[P,M]=r.useState(!1),[N,$]=r.useState([]),[f,R]=r.useState(h),[E,B]=r.useState(null),Z=!!E,T=r.useMemo(()=>{const s=[];for(let t=h;t>=2015;t--)s.push(t);return s},[h]),K=s=>{B(s.currentTarget)},W=()=>{B(null)},ee=s=>{R(s),B(null)},C=r.useCallback(async()=>{if(i){M(!0);try{const s="colleges/faculty_computing/departments",t=F(k,`${s}/${i}/faculty_members`),j=(await I(t)).docs.map(async y=>{const l={id:y.id,name:y.data().name||"Researcher",department:i,departmentName:H[i]||i,hasPublishedThisYear:!1,hasPublishedInSelectedYear:!1,publications:0,publicationsInSelectedYear:0,citations:0},c=F(k,`${s}/${i}/faculty_members/${y.id}/publications`);let d;if(f){const S=fe(c,je("pub_year","==",f));d=await I(S),l.publicationsInSelectedYear=d.size,l.hasPublishedInSelectedYear=d.size>0}else d=await I(c);const u=await I(c);l.publications=u.size;let v=0;return u.forEach(S=>{const _=S.data();v+=_.num_citations||0,_.pub_year===h&&(l.hasPublishedThisYear=!0)}),l.citations=v,l}),g=await Promise.all(j);X(g),$(g)}catch(s){console.error("Error fetching researchers:",s)}finally{M(!1)}}},[i,f,h]),p=r.useMemo(()=>{const s=()=>{if(!n||n.length===0)return 0;const l=n.filter(c=>c.hasPublishedInSelectedYear).length;return Math.min(l/n.length*100,100)},t=()=>!n||n.length===0?0:n.length>0?n.reduce((l,c)=>l+c.publicationsInSelectedYear,0)/n.length:0,o=()=>{if(!n||n.length===0)return 0;const l=n.reduce((d,u)=>d+u.publications,0),c=n.reduce((d,u)=>d+u.citations,0);return l>0?c/l:0},j=n.reduce((l,c)=>l+c.publicationsInSelectedYear,0),g=n.reduce((l,c)=>l+c.citations,0),y=n.filter(l=>l.hasPublishedInSelectedYear).length;return{kpi13:s(),kpi14:t(),kpi15:o(),totalPublications:j,totalCitations:g,researchersWithPublicationsCount:y,researcherCount:n.length}},[n]);r.useEffect(()=>{const s=n.filter(t=>t.name.toLowerCase().includes(Y.toLowerCase()));$(s)},[n,Y]),r.useEffect(()=>{C()},[f,i,C]);const V=s=>{L(s),m(!0)},O=()=>{m(!1),A("")},U=r.useMemo(()=>[{id:"KPI-I-13",name:"% Faculty Published",icon:pe,value:p.kpi13,format:s=>`${s.toFixed(1)}%`,color:"#6366F1",detail:`${p.researchersWithPublicationsCount} of ${p.researcherCount} faculty`,showResearchers:!0,researcherFilter:"published",description:`Percentage of faculty members who published at least one paper in ${f}`},{id:"KPI-I-14",name:"Avg Publications/Faculty",icon:q,value:p.kpi14,format:s=>s.toFixed(1),color:"rgb(77, 167, 208)",detail:`${p.totalPublications} total publications`,showResearchers:!0,researcherFilter:"all",description:`Average number of publications per faculty member in ${f}`},{id:"KPI-I-15",name:"Avg Citations/Publications",icon:J,value:p.kpi15,format:s=>s.toFixed(1),color:"#F59E0B",detail:`${p.totalCitations} total citations`,showResearchers:!1,description:"Average number of citations per publication across all years"}],[p,f]),Q=()=>w==="KPI-I-13"?N.filter(s=>s.hasPublishedInSelectedYear).length:N.length;return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx(b,{variant:"h5",className:"text-gray-800 font-bold",children:"Department Research Metrics"}),e.jsx(D,{icon:e.jsx(ye,{size:18}),label:`Year: ${f}`,color:"secondary",onClick:K,sx:{padding:"4px 8px",height:"auto",cursor:"pointer",backgroundColor:"#6366F1","&:hover":{opacity:.9},"& .MuiChip-icon":{color:"white"}}})]}),e.jsx("div",{className:""}),e.jsx(Fe,{className:"mb-5"}),e.jsx(Ee,{open:Z,anchorEl:E,onClose:W,anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},PaperProps:{style:{width:"90px",maxHeight:"300px",overflowY:"auto",overflowX:"hidden"}},children:e.jsx(Ye,{children:T.map(s=>e.jsx("div",{className:"py-2 px-4 cursor-pointer hover:bg-gray-100",style:{backgroundColor:s===f?"#f0f0f0":"white",borderLeft:s===f?"3px solid #6366F1":"none"},onClick:()=>ee(s),children:s},s))})}),e.jsx(G.div,{className:"grid grid-cols-1 gap-5 sm:grid-cols-2 lg:grid-cols-3 mb-8",initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.3},children:U.map((s,t)=>e.jsx(G.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:t*.05,duration:.2},children:e.jsx(Re,{className:"h-full shadow-md hover:shadow-lg transition-shadow duration-300",children:e.jsxs(_e,{sx:{p:3},children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"rounded-md p-2 mr-3 text-white flex items-center justify-center",style:{backgroundColor:s.color},children:e.jsx(s.icon,{size:20})}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(b,{variant:"h6",className:"text-gray-800 font-medium",children:s.name}),e.jsx(xe,{title:s.description,arrow:!0,children:e.jsx(ue,{size:"small",children:e.jsx(ve,{size:16,className:"text-gray-400"})})})]}),e.jsx(b,{variant:"caption",className:"text-gray-500",children:s.id})]})]}),s.showResearchers&&e.jsx(xe,{title:"View Researchers",arrow:!0,children:e.jsx(ue,{size:"small",onClick:()=>V(s.id),sx:{color:s.color,backgroundColor:`${s.color}10`,"&:hover":{backgroundColor:`${s.color}20`}},children:e.jsx(ne,{size:18})})})]}),e.jsx(b,{variant:"h4",className:"font-bold mb-2",style:{color:s.color},children:s.format(s.value)}),e.jsx(Ve,{variant:"determinate",value:Math.min(s.value,100),sx:{height:4,borderRadius:2,mb:2,backgroundColor:`${s.color}20`,"& .MuiLinearProgress-bar":{backgroundColor:s.color}}}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx(b,{variant:"body2",className:"text-gray-600 text-sm",children:s.detail}),s.showResearchers&&e.jsx(de,{size:"small",variant:"text",onClick:()=>V(s.id),endIcon:e.jsx(we,{}),sx:{color:s.color,textTransform:"none",fontSize:"0.75rem"},children:"View Researchers"})]})]})})},s.id))}),e.jsxs(Le,{open:x,onClose:O,fullWidth:!0,maxWidth:"md",children:[e.jsx(Me,{children:e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("div",{className:"flex flex-wrap justify-between items-center mb-2",children:[e.jsx(b,{variant:"h6",className:"mr-2",children:w==="KPI-I-13"?"Faculty with Publications":"Faculty Members"}),e.jsxs("div",{className:"flex flex-wrap items-center",children:[e.jsx(D,{label:`Dept: ${H[i]||i}`,size:"small",color:"primary",sx:{mr:1,mb:{xs:1,sm:0}}}),e.jsx(D,{label:`Year: ${f}`,size:"small",color:"secondary",onClick:K,sx:{mr:1,mb:{xs:1,sm:0},cursor:"pointer","&:hover":{opacity:.9},bgcolor:"#6366F1"}}),e.jsx(D,{label:`${Q()} researchers`,size:"small",variant:"outlined",sx:{mb:{xs:1,sm:0}}})]})]}),e.jsx(Be,{margin:"dense",placeholder:"Search researchers by name...",fullWidth:!0,variant:"outlined",size:"small",value:Y,onChange:s=>A(s.target.value),InputProps:{startAdornment:e.jsx(Ke,{position:"start",children:e.jsx(ne,{})})}})]})}),e.jsx($e,{dividers:!0,children:P?e.jsxs("div",{className:"flex justify-center items-center py-8",children:[e.jsx(Te,{size:40}),e.jsxs(b,{variant:"body1",color:"text.secondary",sx:{ml:2},children:["Loading researchers from ",H[i]||i,"..."]})]}):e.jsxs(We,{sx:{width:"100%",bgcolor:"background.paper"},children:[(w==="KPI-I-13"?N.filter(s=>s.hasPublishedInSelectedYear):N).map(s=>e.jsxs(me,{alignItems:"flex-start",sx:{borderBottom:"1px solid #f0f0f0","&:hover":{backgroundColor:"#f9f9f9"}},secondaryAction:e.jsxs("div",{className:"flex flex-col items-end",children:[w==="KPI-I-13"?e.jsx(D,{label:`${s.publicationsInSelectedYear||0} publications in ${f}`,size:"small",color:"primary",variant:"filled",sx:{mb:1,bgcolor:"rgb(77, 167, 208)"}}):e.jsx(D,{label:s.hasPublishedInSelectedYear?"Published This Year":"No Publications This Year",size:"small",color:s.hasPublishedInSelectedYear?"primary":"default",variant:s.hasPublishedInSelectedYear?"filled":"outlined",sx:{mb:1,bgcolor:s.hasPublishedInSelectedYear?"rgb(77, 167, 208)":""}}),e.jsxs(b,{variant:"caption",color:"text.secondary",children:["Total Citations: ",s.citations]})]}),children:[e.jsx(Oe,{children:e.jsx(De,{sx:{bgcolor:s.hasPublishedInSelectedYear?"rgb(77, 167, 208)":"#9CA3AF"},children:s.name.charAt(0)})}),e.jsx(he,{primary:s.name,secondary:e.jsxs(be.Fragment,{children:[e.jsx(b,{sx:{display:"block"},component:"span",variant:"body2",color:"text.primary",children:s.departmentName||s.department}),e.jsxs(b,{sx:{display:"block"},component:"span",variant:"body2",color:"text.secondary",children:["Total Publications: ",s.publications]})]})})]},s.id)),!P&&(w==="KPI-I-13"?N.filter(s=>s.hasPublishedInSelectedYear).length===0:N.length===0)&&e.jsx(me,{children:e.jsx(he,{primary:w==="KPI-I-13"?`No faculty members published in ${f}`:"No researchers found",secondary:Y?"Try adjusting your search criteria":`No data available for ${H[i]||i}`})})]})}),e.jsx(ze,{children:e.jsx(de,{onClick:O,children:"Close"})})]})]})},ae=[{value:"dept_cs",label:"Computer Science"},{value:"dept_it",label:"Information Technology"},{value:"dept_se",label:"Software Engineering"},{value:"dept_sn",label:"Network Systems"}],re=({name:a,icon:i,value:h,color:x,detail:m})=>{const w=h.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",");return e.jsx(G.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.2},children:e.jsxs("div",{className:"bg-white rounded-lg shadow-md hover:shadow-lg transition-shadow duration-300 h-full p-4",children:[e.jsxs("div",{className:"flex items-center mb-2",children:[e.jsx("div",{className:"rounded-md p-2 mr-3 text-white flex items-center justify-center",style:{backgroundColor:x},children:e.jsx(i,{size:18})}),e.jsx("div",{children:e.jsx(b,{variant:"subtitle2",className:"text-gray-600 font-medium",children:a})})]}),e.jsxs("div",{className:"ml-10",children:[e.jsx(b,{variant:"h5",className:"font-bold",style:{color:x},children:w}),m&&e.jsx(b,{variant:"body2",className:"text-gray-500 text-xs",children:m})]})]})})},qe=({publication:a,onClose:i})=>{if(!a)return null;const h=x=>{x.target===x.currentTarget&&i()};return be.useEffect(()=>{const x=m=>{m.key==="Escape"&&i()};return document.addEventListener("keydown",x),()=>{document.removeEventListener("keydown",x)}},[i]),e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4 cursor-pointer",onClick:h,children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-4xl w-full max-h-[90vh] overflow-auto cursor-default",onClick:x=>x.stopPropagation(),children:[e.jsxs("div",{className:"flex justify-between items-center p-4 border-b",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Publication Details"}),e.jsx("button",{onClick:i,className:"text-gray-400 hover:text-gray-600 focus:outline-none","aria-label":"Close",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"p-6",children:[e.jsx("h2",{className:"text-2xl font-semibold text-blue-500 mb-4",children:a.title}),e.jsx("div",{className:"flex flex-wrap gap-2 mb-6",children:a.authors&&Array.isArray(a.authors)&&a.authors.map((x,m)=>e.jsx("span",{className:"bg-gray-100 px-3 py-1 rounded-full text-sm",children:x},m))}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-8",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-gray-500 mb-2",children:"DETAILS"}),e.jsx("div",{className:"space-y-2",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx("span",{className:"text-blue-500 mr-2",children:e.jsx(J,{})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-500",children:"Citations"}),e.jsx("div",{children:a.num_citations||0})]})]})})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-gray-500 mb-2",children:"ABSTRACT"}),e.jsx("p",{className:"text-sm text-gray-700",children:a.abstract||"No abstract available"})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-gray-500 mb-2",children:"Keywords"}),e.jsx("div",{children:a.keywords?e.jsx("div",{className:"flex flex-wrap gap-1",children:a.keywords.map((x,m)=>e.jsx("span",{className:"bg-blue-100 text-blue-700 px-2 py-1 text-xs rounded",children:x},m))}):e.jsx("p",{className:"text-sm text-gray-500",children:"No keywords available"})}),e.jsx("h3",{className:"font-medium text-gray-500 mt-6 mb-2",children:"Actions"}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsxs("button",{className:"flex items-center gap-1 text-blue-500 border border-blue-200 rounded-full px-3 py-1 text-sm hover:bg-blue-50",children:[e.jsx(ie,{className:"text-xs"})," View Online"]}),e.jsxs("button",{className:"flex items-center gap-1 text-blue-500 border border-blue-200 rounded-full px-3 py-1 text-sm hover:bg-blue-50",children:[e.jsx(ge,{className:"text-xs"})," Download PDF"]}),e.jsxs("button",{className:"flex items-center gap-1 text-blue-500 border border-blue-200 rounded-full px-3 py-1 text-sm hover:bg-blue-50",children:[e.jsx(Se,{className:"text-xs"})," Share"]}),e.jsxs("button",{className:"flex items-center gap-1 text-blue-500 border border-blue-200 rounded-full px-3 py-1 text-sm hover:bg-blue-50",children:[e.jsx(ke,{className:"text-xs"})," Print"]})]})]})]})]})]})})},Ge=({publication:a,onClick:i})=>{const h=()=>a.authors?Array.isArray(a.authors)?a.authors.length===0?"-":a.authors.length<=3?a.authors.join(", "):a.authors.slice(0,3).join(", ")+" et al.":a.authors:"-";return e.jsxs("div",{className:"border-b py-4 px-3",children:[e.jsx("div",{className:"text-blue-600 font-medium mb-2 cursor-pointer hover:underline",onClick:()=>i(a),children:a.title||"Untitled"}),e.jsx("div",{className:"text-gray-500 text-sm",children:h()}),e.jsxs("div",{className:"flex justify-between mt-2 text-sm",children:[e.jsxs("div",{className:"text-gray-600",children:[e.jsx("span",{className:"mr-3",children:a.pub_year||"Unknown"}),e.jsxs("span",{className:"flex items-center inline-flex",children:[e.jsx(J,{className:"mr-1 text-xs"}),a.num_citations||0]})]}),e.jsxs("div",{className:"flex space-x-2",children:[a.pub_url&&e.jsx("a",{href:a.pub_url,target:"_blank",rel:"noopener noreferrer",className:"text-blue-500 hover:text-blue-700",children:e.jsx(ie,{})}),e.jsx("button",{className:"text-blue-500 hover:text-blue-700",onClick:()=>i(a),children:e.jsx(Ce,{})})]})]})]})},Je=({authors:a})=>{const[i,h]=r.useState(!1);return!a||!Array.isArray(a)||a.length===0?e.jsx("span",{className:"text-gray-500",children:"-"}):a.length<=3||i?e.jsxs("div",{children:[e.jsx("span",{children:a.join(", ")}),a.length>3&&e.jsx("button",{onClick:()=>h(!1),className:"ml-2 text-blue-500 text-xs hover:underline focus:outline-none",children:"Show less"})]}):e.jsxs("div",{children:[e.jsx("span",{children:a.slice(0,3).join(", ")}),e.jsx("span",{children:" et al."}),e.jsx("button",{onClick:()=>h(!0),className:"ml-2 text-blue-500 text-xs hover:underline focus:outline-none",children:"more"})]})},cs=()=>{const[a,i]=r.useState(""),[h,x]=r.useState(""),[m,w]=r.useState({totalPublications:0,totalCitations:0,facultyMembers:0,facultyWithPublicationsThisYear:0}),[L,Y]=r.useState([]),[A,n]=r.useState([]),[X,P]=r.useState(!0),[M,N]=r.useState(!1),[$,f]=r.useState(null),[R,E]=r.useState(""),[B,Z]=r.useState(null),[T]=r.useState(10),[K,W]=r.useState(1),[ee,C]=r.useState(!1),p=r.useMemo(()=>{if(!R)return L;const t=R.toLowerCase();return L.filter(o=>o.title&&o.title.toLowerCase().includes(t)||o.authors&&Array.isArray(o.authors)&&o.authors.some(j=>j.toLowerCase().includes(t)))},[L,R]);r.useEffect(()=>{p.length>0?(n(p.slice(0,T)),W(1)):n([])},[p,T]),r.useEffect(()=>{(async()=>{try{const o=Pe.currentUser;if(!o){C(!0),P(!1);return}const j=oe(k,"departmentAdmins",o.uid),g=await ce(j);if(g.exists()){const c=g.data();if(c.department){const d=c.department;i(d);const u=ae.find(v=>v.value===d);u&&x(u.label),await U(d),await Q(d),P(!1);return}}const y=oe(k,"users",o.uid),l=await ce(y);if(l.exists()){const c=l.data();if(c.roles){const d=Object.keys(c.roles).find(u=>u.startsWith("dept_admin_")&&c.roles[u]===!0);if(d){Z(d);const u="dept_"+d.split("dept_admin_")[1];i(u);const v=ae.find(S=>S.value===u);v&&x(v.label),await U(u),await Q(u)}else C(!0)}else C(!0)}else C(!0)}catch(o){console.error("Error fetching user role:",o),C(!0)}finally{P(!1)}})()},[]);const V=()=>{N(!0),setTimeout(()=>{const t=K+1,o=p.slice(0,t*T);n(o),W(t),N(!1)},500)},O=A.length<p.length,U=async t=>{P(!0);try{let o=0,j=0,g=0,y=0;const l=new Date().getFullYear(),c=F(k,`colleges/faculty_computing/departments/${t}/faculty_members`),d=await I(c);g=d.size;const u=d.docs.map(async v=>{const S=F(k,`colleges/faculty_computing/departments/${t}/faculty_members/${v.id}/publications`),_=await I(S);let z=!1;_.forEach(se=>{o++;const le=se.data();j+=le.num_citations||0,le.pub_year===l&&!z&&(z=!0,y++)})});await Promise.all(u),w({totalPublications:o,totalCitations:j,facultyMembers:g,facultyWithPublicationsThisYear:y})}catch(o){console.error("Error fetching statistics: ",o)}finally{P(!1)}},Q=async t=>{try{const o=F(k,`colleges/faculty_computing/departments/${t}/faculty_members`),g=(await I(o)).docs.map(async d=>{const u=F(k,`colleges/faculty_computing/departments/${t}/faculty_members/${d.id}/publications`),v=fe(u,Ie("num_citations","desc"),Ae(50));return(await I(v)).docs.map(_=>{var z;return{id:_.id,researcherName:d.data().name,department:((z=ae.find(se=>se.value===t))==null?void 0:z.label)||t,..._.data()}})}),l=(await Promise.all(g)).flat();l.sort((d,u)=>(u.num_citations||0)-(d.num_citations||0));const c=l.slice(0,50);Y(c),n(c.slice(0,T))}catch(o){console.error("Error fetching top cited publications: ",o)}},s=t=>{f(t)};return X?e.jsxs("div",{className:"flex-1 flex flex-col",children:[e.jsx(te,{title:"Loading...",showViewSwitcher:!1,isDepartmentAdmin:!0}),e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsx(Qe,{size:30,color:"#6366F1"})})]}):ee||!a?e.jsxs("div",{className:"flex-1 flex flex-col",children:[e.jsx(te,{showViewSwitcher:!1,title:"Access Denied"}),e.jsx("div",{className:"flex-1 flex items-center justify-center",children:e.jsxs("div",{className:"text-center p-8 bg-gray-50 rounded-lg shadow-md",children:[e.jsx("svg",{className:"w-16 h-16 text-gray-400 mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),e.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-2",children:"Access Denied"}),e.jsx("p",{className:"text-gray-600",children:"You don't have department admin privileges. Please contact system administrator for assistance."})]})})]}):e.jsxs("div",{className:"flex-1 flex flex-col",children:[e.jsx(te,{title:h+" Department Dashboard",showViewSwitcher:!1,isDepartmentAdmin:!0}),e.jsx("div",{className:"flex-1 relative z-10 overflow-auto",children:e.jsxs("main",{className:"mx-auto py-6 px-4 lg:px-8",children:[e.jsx("div",{className:"flex justify-end mb-6",children:e.jsx(Ue,{currentView:"admin",departmentCode:a})}),e.jsxs(G.div,{className:"grid grid-cols-1 gap-5 sm:grid-cols-2 lg:grid-cols-3 mb-8",initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.3},children:[e.jsx(re,{name:"Department Publications",icon:q,value:m.totalPublications,color:"rgb(29 78 216)"}),e.jsx(re,{name:"Total Citations",icon:J,value:m.totalCitations,color:"rgb(29 78 216)"}),e.jsx(re,{name:"Faculty Members",icon:pe,value:m.facultyMembers,color:"rgb(29 78 216)",detail:`${m.facultyWithPublicationsThisYear} with publications this year`})]}),e.jsx(He,{statistics:m,selectedDepartment:a}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8 mb-8",children:[e.jsxs("div",{className:"bg-white shadow-lg rounded-lg p-6 border border-gray-200",children:[e.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Publications Over Time"}),e.jsx("div",{className:"h-64 flex items-center justify-center bg-gray-50"})]}),e.jsxs("div",{className:"bg-white shadow-lg rounded-lg p-6 border border-gray-200",children:[e.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Citations Per Year"}),e.jsx("div",{className:"h-64 flex items-center justify-center bg-gray-50"})]})]}),e.jsxs("div",{className:"bg-white shadow-lg rounded-lg p-6 border border-gray-200 mb-8",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"rounded-md p-2 mr-3 text-white flex items-center justify-center bg-blue-500",children:e.jsx(q,{size:20})}),e.jsxs("div",{children:["Top Publications (",p.length,")"]})]}),e.jsx("div",{className:"w-64",children:e.jsx("input",{type:"text",value:R,onChange:t=>E(t.target.value),placeholder:"Search publications...",className:"w-full py-2 px-3 border border-gray-300 bg-white rounded-md leading-5 placeholder-gray-500 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"})})]}),A.length>0?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"hidden md:block overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-2/5",children:"Title"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-1/6",children:"Authors"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-1/12",children:"Year"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-1/12",children:"Citations"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-1/6",children:"Journal"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-1/12",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:A.map(t=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 text-sm font-medium text-blue-600 cursor-pointer max-w-xl overflow-hidden",onClick:()=>s(t),children:e.jsx("div",{className:"text-ellipsis overflow-hidden",children:t.title||"Untitled"})}),e.jsx("td",{className:"px-6 py-4 whitespace-normal text-sm text-gray-700 max-w-[200px]",children:e.jsx(Je,{authors:t.authors})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:t.pub_year||"Unknown"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:t.num_citations||0}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 max-w-[150px] truncate",children:t.journal||"-"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.jsxs("div",{className:"flex space-x-2",children:[t.pub_url&&e.jsx("a",{href:t.pub_url,target:"_blank",rel:"noopener noreferrer",className:"text-blue-500 hover:text-blue-700",children:e.jsx(ie,{})}),e.jsx("button",{className:"text-blue-500 hover:text-blue-700",children:e.jsx(ge,{})}),e.jsx("button",{className:"text-blue-500 hover:text-blue-700",children:e.jsx(Ne,{})})]})})]},t.id))})]})}),e.jsxs("div",{className:"md:hidden",children:[e.jsxs("div",{className:"bg-gray-50 py-2 px-4 flex justify-between text-xs font-medium text-gray-500 uppercase",children:[e.jsx("div",{children:"Title / Authors"}),e.jsx("div",{children:"Actions"})]}),e.jsx("div",{className:"divide-y divide-gray-200",children:A.map(t=>e.jsx(Ge,{publication:t,onClick:s},t.id))})]}),O&&e.jsx("div",{className:"flex justify-center mt-6",children:e.jsx("button",{onClick:V,disabled:M,className:"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors disabled:opacity-50",children:M?e.jsxs("span",{className:"flex items-center",children:[e.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Loading..."]}):e.jsx("span",{children:"Load More"})})})]}):e.jsxs("div",{className:"py-12 text-center bg-gray-50 rounded-lg",children:[e.jsx("div",{className:"inline-block p-3 rounded-full bg-gray-100 mb-4",children:e.jsx(q,{className:"h-8 w-8 text-gray-400"})}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-1",children:"No publications found"}),e.jsx("p",{className:"text-gray-500",children:"Try adjusting your search to find publications"})]})]}),$&&e.jsx(qe,{publication:$,onClose:()=>f(null)})]})})]})};export{cs as default};
